import{w as D}from"./workerpool.79c1317a.js";import{i as R}from"./echarts.9bdfea43.js";let b=E();const f={},h=[],M=D.pool(new URL("/multi-charts-comparison/assets/CompiledWorker.b0810f53.js",self.location).href,{maxWorkers:3});function E(){return Date.now()}function j(e){h.push(M.exec(e.name,[e.data]))}function L(e){console.log(e?`Terminating operation: ${e}`:"Clearing worker queue"),f[e]&&f[e](`Operation ${e} terminated`),M.terminate(!0),h.length=0}function k(e){return L(),b=e,()=>new Promise((t,n)=>{f[e]=n,Promise.all(h).then(a=>t(a)).catch(()=>{})})}function S(e){const t=E(),n=k(t);return console.log(`Starting operation ${t}`),e(j),n().then(a=>b===t?(console.log(`Operation ${t} ended with results`,a),a):(console.log(`Operation ${t} ended but was terminated`,a),Promise.reject(`Operation ${t} ended but was terminated`)))}const z={channels:{label:"Channels",min:10,max:25,value:10},period:{label:"Sleep period (h)",min:8,max:14,value:8},samples:{label:"Samples per second",min:1,max:100,value:1},total:{label:"Total samples"},lastEvent:{label:"Last event"},extraFeatures:{toggleGrid:!0,areaZoom:!1,montages:[],extrapolation:!1,toggleHotkeys:!1,events:!1,hotkeys:[{key:"left",label:"Pan left",action:"panLeft"},{key:"right",label:"Pan right",action:"panRight"}]}};function m(e,t){return Math.random()*(t-e)+e}function O(e,t){let n=!1;return()=>{n||(e.apply(this,arguments),n=!0,setTimeout(()=>{n=!1},t))}}function B(e,t){let n=null;return()=>{n&&clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),n=null,e.apply(this,arguments)},t)}}const re={get:(e,t,n)=>{if(e[t]&&typeof e[t]=="function")return e[t].bind(e);throw new Error(`API doesn't exist: ${t}`)}},T={generateDataSeries:"generateDataSeries",generatePunchedDataSeries:"generatePunchedDataSeries",setTotalSamples:"setTotalSamples"};function $(e,t){return{name:T.generateDataSeries,data:{channel:e,samples:t}}}function H(e,t){return{name:T.generatePunchedDataSeries,data:{channel:e,samples:t}}}const o=[{name:"PAT",start:0,end:0,dataMin:-1e3,dataMax:1e3,yAxisMin:-1e3,yAxisMax:1e3,displacement:10,smoothing:-.3},{name:"PAT Amplitude",easingType:0,yAxisMin:-1e3,yAxisMax:1e3,dataMin:500,dataMax:800,start:750,end:750,displacement:100,displacementRatio:.4},{name:"Pulse rate (BPM)",easingType:0,yAxisMin:0,yAxisMax:100,dataMin:50,dataMax:80,start:75,end:75,displacement:5,displacementRatio:.4},{name:"SaO2 (%)",yAxisMin:80,yAxisMax:100,dataMin:86,dataMax:94,start:90,end:90,displacement:3,smoothing:.6},{name:"Resp.Mov",yAxisMin:-1e4,yAxisMax:1e4,dataMin:-1e4,dataMax:1e4,start:0,end:0,displacement:120,smoothing:-.1},{name:"Actigraph",yAxisMin:1500,yAxisMax:3e3,dataMin:1500,dataMax:3e3,start:1700,end:1700,displacement:10,smoothing:.1},{name:"Snore (dB)",yAxisMin:35,yAxisMax:75,dataMin:40,dataMax:75,start:40,end:40,displacement:80,displacementRatio:.04,smoothing:.01,easingType:2},{name:"Channel 8",displacement:50,smoothing:.5,dynamicYAxis:!0},{name:"Channel 9",displacement:20,smoothing:.9,dynamicYAxis:!0},{name:"Channel 10",displacement:300,smoothing:1.2,dynamicYAxis:!0}];function w(...e){return z.extraFeatures.extrapolation?H(...e):$(...e)}function g(e){return{name:"Channel "+e,displacement:m(30,400),smoothing:m(.1,2),displacementRatio:m(.1,1)}}function se(e){return S(t=>{o.forEach(n=>t(w(n,e)))})}function le(e,t,n=!0){if(e<1)throw new Error("Can't add 0 channels");return S(a=>{for(let i=0;i<e;i++){const c=o.length+1;n?a(w(o[o.push(g(c))-1],t)):o.push(g(c))}})}function de(e){o.splice(o.length+e,-e)}function N(e){return{min:typeof e.yAxisMin=="number"?e.yAxisMin:e.dataMin,max:typeof e.yAxisMax=="number"?e.yAxisMax:e.dataMax}}const l={init:"init",render:"render",zoomPan:"zoomPan",dataOperationStart:"dataOperationStart",dataOperationEnd:"dataOperationEnd"};function U(){}function G(){const e=Object.keys(l).reduce((n,a)=>(n[l[a]]=U,n),{}),t=(...n)=>{n[0]in l&&(e[n[0]]=n[1])};return e.on=t,e.dataOperationStarted=()=>{e.dataOperationStart({type:l.dataOperationStart})},e.dataOperationEnded=()=>{e.dataOperationEnd({type:l.dataOperationEnd})},e}const v={toolbox:{left:"left",top:5,feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},axisPointer:{link:[{xAxisIndex:"all"}]}};var ue=Object.freeze(Object.defineProperty({__proto__:null,defaults:v},Symbol.toStringTag,{value:"Module"}));const d={onBeforeDataUpdate:"onBeforeDataUpdate",dataZoom:"dataZoom",brushselected:"brushselected",finished:"finished"},r=G();function p(...e){if(!(e[0]in l)&&!(e[0]in d)){typeof e[0]=="object"&&e[0].on(...e.slice(1));return}switch(e[0]){case d.onBeforeDataUpdate:r[d.onBeforeDataUpdate]=e[1];return;default:r.on(...e)}}let s=null,x=!1;const Z=O(()=>{s={type:l.zoomPan,timestamp:performance.now()}},150),I=B(()=>{if(s){const e=(performance.now()-s.timestamp)/1e3;s.type===d.onBeforeDataUpdate&&(x?r.render({duration:e,type:l.render}):(x=!0,r.init({duration:e,type:l.init}))),r[s.type]&&r[s.type]({duration:e,type:s.type}),s=null}},100),_={[d.brushselected]:Z,[d.finished]:I};p(d.onBeforeDataUpdate,()=>{s={type:d.onBeforeDataUpdate,timestamp:performance.now()}});var ce=Object.freeze(Object.defineProperty({__proto__:null,ECHARTS_EVENTS:d,graphEvents:r,on:p,ECHARTS_EVENT_HANDLERS:_},Symbol.toStringTag,{value:"Module"}));const V={type:"time",boundaryGap:!1,axisLine:{onZero:!0}};function Y(e){return{gridIndex:e,position:"top",show:!e,...V}}const F={offset:35,type:"value",realtimeSort:!1,boundaryGap:!1,splitNumber:0,nameRotate:0,nameLocation:"middle",nameGap:0,axisLabel:{interval:0,showMinLabel:!0,showMaxLabel:!0,margin:-25,fontSize:8}};function q(e,t,n){return{gridIndex:e,name:t,...n,...F}}const Q={realtime:!0,start:0,end:100};function y(e,t){return{...Q,...t,xAxisIndex:Object.keys(e)}}const W={left:130,right:20};function K(e){return e.map((t,n)=>({...W,top:10+n*90/e.length+"%",height:70/e.length+"%"}))}const X={type:"line",symbol:"none",sampling:"lttb",lineStyle:{width:1}};function J(e,t){return{...X,encode:{x:"timestamp",y:`channel_${t}`},xAxisIndex:t,yAxisIndex:t}}function C(e,t){const n={xAxis:e.map((a,i)=>Y(i)),yAxis:e.map((a,i)=>q(i,a.name,{...N(a),inverse:a.inverse})),dataZoom:[y(e,{type:"inside"}),y(e,{type:"slider",top:"top"})],grid:K(e),series:e.map((a,i)=>J(a,i))};return t&&(n.dataset={source:t}),n}var pe=Object.freeze(Object.defineProperty({__proto__:null,buildEchartsOptions:C},Symbol.toStringTag,{value:"Module"}));let u,A=!1;function ee(e){r.onBeforeDataUpdate(),u=R(e),Object.entries(_).forEach(([t,n])=>{p(u,t,n)}),window.addEventListener("resize",O(()=>{u.resize()},150))}function te(e,t){A?r.onBeforeDataUpdate():A=!0,e&&(e=P(e,t));const n=C(o,e);u.setOption(Object.assign(v,n),{replaceMerge:["series","yAxis","xAxis","grid"]})}function P(e,t){const n={};for(let a=0;a<e.length;a++){const i=o.length-e.length+a,c=e[a];n[`channel_${i}`]=c.data}return e.length===o.length&&(n.timestamp=t),n}function ne(){u.showLoading()}function ae(){u.hideLoading()}var me=Object.freeze(Object.defineProperty({__proto__:null,init:ee,update:te,buildModel:P,showLoading:ne,hideLoading:ae,graphEvents:r,on:p},Symbol.toStringTag,{value:"Module"}));export{me as E,l as G,G as a,re as b,o as c,se as d,le as e,B as f,N as g,ue as h,ce as i,pe as j,de as r,z as u};
