import{l as r}from"./vendor.d274a670.js";import{c as p,g as D,G as A}from"./echarts.renderer.f38a4c36.js";function I(n=new Date){return n.setDate(n.getDate()-1),n.setHours(22)}const P={channels:{label:"Channels",min:10,max:25,value:10},period:{label:"Sleep period (h)",min:8,max:14,value:8},samples:{label:"Samples per second",min:1,max:100,value:1},total:{label:"Total samples"},lastEvent:{label:"Last event"},extraFeatures:{toggleGrid:!0,areaZoom:!1,montages:[]}};var X=P;const E=n=>class m extends n{static addChannel(e,t,i,s,a=!1){const o=e.createChartXY({columnIndex:0,rowIndex:i,columnSpan:1,rowSpan:1,disableAnimations:!0}).setTitle("").setPadding({left:100,top:0,bottom:0}).setBackgroundStrokeStyle(r.emptyLine).setMouseInteractions(!1).setMouseInteractionPan(!0).setSeriesBackgroundFillStyle(new r.SolidFill({color:r.ColorCSS("white")})),h=o.getDefaultAxisX().setMouseInteractions(!1).setTickStrategy(r.AxisTickStrategies.Empty,c=>console.log(c)).setStrokeStyle(r.emptyLine),d=o.getDefaultAxisY().setMouseInteractions(!1).setChartInteractions(!1).setStrokeStyle(r.emptyLine).setTitle(t.name).setTitleFont(new r.FontSettings({size:12})).setTitleFillStyle(new r.SolidFill({color:r.ColorHEX("#6e7079")})).setTitleRotation(0).setThickness(60).setAnimationZoom(void 0).setTickStrategy(r.AxisTickStrategies.Numeric,c=>c.setMajorTickStyle(g=>g.setLabelFillStyle(new r.SolidFill({color:r.ColorHEX("#6e7079")})).setLabelFont(new r.FontSettings({size:6})).setTickStyle(r.emptyLine)).setMinorTickStyle(g=>g.setLabelFont(new r.FontSettings({size:6})).setTickStyle(r.emptyLine)));let l;return a||(l=m.addLineSeries(o,typeof s=="number"?s:i)),{chart:o,series:l,xAxis:h,yAxis:d,row:i}}static addLineSeries(e,t=0){return e.addLineSeries({dataPattern:{pattern:"ProgressiveX",regularProgressiveStep:!0,allowDataGrouping:!0},automaticColorIndex:t}).setStrokeStyle(i=>i.setThickness(-1))}addChannel(e,t,i,s){return m.addChannel(this.dashboard,e,t,i,s)}addLineSeries(e,t){return m.addLineSeries(e,t)}initializeChannels(e){this.graphs.splice(0,0,...e.map((t,i)=>this.addChannel(t,i))),this.graphs.forEach(t=>this.registerZoomEvents(t))}};var Y=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),v=`<svg id="areazoom-svg" style="position: absolute; z-index: 10000; width: 100%; height: 100%; pointer-events: none;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <!-- <rect id="resize" fill="red" x="190" y="160" width="20" height="20" /> -->
  <rect id="areazoom-rect" fill="rgba(50, 50, 50, 0.5)" />
</svg>`;let f,S;function b(n){n.insertAdjacentHTML("beforeend",v),f=document.getElementById("areazoom-rect")}function G(n){f.setAttribute("height",n)}function w(n){S=n,f.setAttribute("x",n)}function C(n){n>S?f.setAttribute("width",n-S):(f.setAttribute("width",S-n),f.setAttribute("x",n))}function k(){const n=f.getAttribute("x"),u=f.getAttribute("width");return f.setAttribute("width",0),{x:n|0,width:u|0}}var q=Object.freeze(Object.defineProperty({__proto__:null,svg:v,init:b,setHeight:G,setPosition:w,move:C,hide:k},Symbol.toStringTag,{value:"Module"})),U=Object.freeze(Object.defineProperty({__proto__:null,svg:v,init:b,setHeight:G,setPosition:w,move:C,hide:k},Symbol.toStringTag,{value:"Module"}));const M=n=>class y extends n{static visibleGridStyle=new r.SolidLine({thickness:1,fillStyle:new r.SolidFill({color:r.ColorCSS("#dfdfdf")})});static hiddenGridStyle=r.emptyLine;static getNewDashboard(e,t){return r.lightningChart({overrideInteractionMouseButtons:{chartXYPanMouseButton:0,chartXYRectangleZoomFitMouseButton:2}}).Dashboard({container:e,numberOfColumns:1,numberOfRows:t,theme:r.Themes.lightNew}).setBackgroundFillStyle(new r.SolidFill({color:r.ColorCSS("white")})).setSplitterStyle(r.emptyLine).setSplitterStyleHighlight(r.emptyLine)}get maxVisibleCharts(){return super.maxVisibleCharts*2+1}get mainGraph(){return this.graphGroup||super.mainGraph}constructor(...e){super(...e);this.pinnedGraphs=[]}newDashboard(e,t=this.maxVisibleCharts){this.dashboard=y.getNewDashboard(e,t),b(e)}updateDashboardRowHeights(){const{dashboard:e,graphs:t,pinnedGraphs:i,mainGraph:s,maxVisibleCharts:a}=this,o=t.map((g,H)=>H).filter(g=>!p[g].isHidden);s.isGroup&&o.push(s.graphIndex);const h=i.map(g=>g.pinnedIndex),d=o.concat(h),l=s.xAxis.getHeight(),c=(e.engine.container.clientHeight-l)/d.length;for(let g=0;g<a;g++)d.includes(g)?e.setRowHeight(g,Math.round(c)):e.setRowHeight(g,1e-5);e.setRowHeight(s.row,Math.round(c+l)),window.dashboard=e,G(o.length*c)}setXAxisStyle(){this.graphs.forEach((e,t)=>{e.xAxis.setTickStrategy(r.AxisTickStrategies.Empty)}),this.mainGraph.xAxis.setTickStrategy(r.AxisTickStrategies.DateTime,e=>e.setDateOrigin(new Date(I())).setMajorTickStyle(t=>t.setGridStrokeStyle(r.emptyLine).setTickStyle(r.emptyLine)).setMinorTickStyle(t=>t.setGridStrokeStyle(r.emptyLine).setTickStyle(r.emptyLine)))}syncXAxesZoom(){this.axisSyncHandle&&this.axisSyncHandle.remove();const e=this.graphs.map(t=>t.xAxis);this.mainGraph.isGroup&&e.push(this.mainGraph.xAxis),this.axisSyncHandle=r.synchronizeAxisIntervals(...e)}resetView(){const{mainGraph:e,minX:t,maxX:i}=this;e.xAxis.setInterval(t,i,!1,!0)}toggleGrid(e){this.graphs.forEach(t=>{const i=t.yAxis.getTickStrategy();t.yAxis.setTickStrategy(i,s=>s.setMajorTickStyle(a=>a.setGridStrokeStyle(e?y.visibleGridStyle:y.hiddenGridStyle)))})}toggleChannelVisibility(e,t=!1){const i=this.graphs[e];p[e].isHidden?(i.series.dispose(),i.yAxis.dispose()):(i.series.restore(),i.yAxis.restore()),t||this.updateDashboardRowHeights()}toggleChannelSticky(e,t=!1,i=NaN){const{pinnedGraphs:s,graphs:a}=this,o=a[e],h=p[e];if(h.isSticky){const d=isNaN(i)?s.length&&s[s.length-1].pinnedIndex-1||this.maxVisibleCharts-1:i,l=this.addChannel(h,d,e);l.pinnedIndex=d,s.push(l),l.series.add(o.series.kc[0].La),h.pinnedGraph=l}else{if(!h.pinnedGraph)return;const d=h.pinnedGraph;h.pinnedGraph=null,s.splice(s.indexOf(d),1).forEach(l=>{l.chart.dispose();for(let c in l)l[c]=null})}t||this.updateDashboardRowHeights()}addGraphGroup(){const e=Math.floor(this.maxVisibleCharts/2);this.graphGroup=this.addChannel({name:"Channel Group"},e,null,!0),this.graphGroup.isGroup=!0,this.graphGroup.graphIndex=e,this.graphGroup.series={}}toggleChannelGrouped(e,t=!1){if(p[e].isGrouped){this.mainGraph.isGroup||this.addGraphGroup();const{graphs:i,mainGraph:s}=this,a=i[e],o=this.addLineSeries(s.chart,e);s.series[e]=o,o.add(a.series.kc[0].La)}else{if(!this.mainGraph.isGroup)return;const{mainGraph:i}=this,s=i.series[e];if(!s)return;if(s.dispose(),i.series[e]=null,delete i.series[e],Object.keys(i.series).length===0){i.chart.dispose();for(let a in i)i[a]=null;this.graphGroup=null}}t||(this.setXAxisStyle(),this.syncXAxesZoom(),requestAnimationFrame(()=>{this.updateDashboardRowHeights()}))}newMontage(){return p.map((e,t)=>({channelIndex:t,isHidden:e.isHidden,isSticky:e.isSticky,isGrouped:e.isGrouped,pinnedGraphIndex:e.pinnedGraph&&e.pinnedGraph.pinnedIndex}))}loadMontage(e){if(this.pinnedGraphs.splice(0).forEach(t=>{t.chart.dispose();for(let i in t)t[i]=null}),this.mainGraph.isGroup){this.graphGroup.chart.dispose();for(let t in this.mainGraph)this.mainGraph[t]=null;this.graphGroup=null}e.forEach((t,i)=>{p[i].isHidden=t.isHidden,p[i].isSticky=t.isSticky,p[i].isGrouped=t.isGrouped,this.toggleChannelVisibility(i,!0),this.toggleChannelSticky(i,!0,t.pinnedGraphIndex),this.toggleChannelGrouped(i)}),this.updateDashboardRowHeights()}};var W=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));const L=n=>class extends n{constructor(...e){super(...e);this.lastEvent=null,this.hasInitialized=!1,this.graphEvents=D()}markEvent(){this.lastEvent={timestamp:performance.now()}}registerZoomEvents(e){e.chart.onSeriesBackgroundMouseWheel((t,i)=>{let{deltaY:s}=i;const{xAxis:a,yAxis:o}=e,{start:h,end:d}=a.getInterval();s=-s;const l=this.getNewInterval(h,d,s);a.setInterval(l.start,l.end,!1,!0)})}getNewInterval(e,t,i,s=1e4){if(s<1e3)return!1;const{minX:a,maxX:o}=this,h=Math.min(o,Math.max(a,e+i*s)),d=Math.max(a,Math.min(o,t-i*s));return h*2>o?this.getNewInterval(e,t,i,s/2):{start:h,end:d}}reportRenderEvent(){requestAnimationFrame(()=>{const e=(performance.now()-this.lastEvent.timestamp)/1e3;this.hasInitialized?this.graphEvents.render({duration:e,type:A.render}):(this.hasInitialized=!0,this.graphEvents.init({duration:e,type:A.init})),this.lastEvent=null})}toggleAreaZoom(e){e?this.graphs.forEach(t=>{const{chart:i}=t;i.setMouseInteractionPan(!1),t.chartEvents={offSeriesBackgroundMouseDragStart:i.onSeriesBackgroundMouseDragStart((s,a,o)=>{o===0&&w(a.offsetX)}),offSeriesBackgroundMouseDrag:i.onSeriesBackgroundMouseDrag((s,a,o)=>{o===0&&C(a.offsetX)}),offSeriesBackgroundMouseDragStop:i.onSeriesBackgroundMouseDragStop((s,a,o)=>{if(o!==0)return;const h=k(),d=s.getSeries()[0].scale.x.getPixelSize(),c=this.mainGraph.xAxis.getInterval().start/d-160;this.mainGraph.xAxis.setInterval((c+h.x)*d,(c+h.x+h.width)*d,!1,!0)})}}):this.graphs.forEach(t=>{const{chart:i}=t;for(const[s,a]of Object.entries(t.chartEvents))i[s](a),t.chartEvents[s]=null;i.setMouseInteractionPan(!0)})}};var K=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));class T{get minX(){return this.timeSeries[0]}get maxX(){return this.timeSeries[this.timeSeries.length-1]}get mainGraph(){return this.graphs[this.graphs.length-1]}get maxVisibleCharts(){return X.channels.max}constructor(){this.graphs=[]}init(u){this.markEvent(),this.newDashboard(u),this.initializeChannels(p),u.addEventListener("wheel",e=>{e.preventDefault()},{passive:!1})}update(u=[],e){this.hasInitialized&&this.markEvent(),e&&(this.timeSeries=e);const{graphs:t}=this,i=t.length;this.hasChannelsChanged=!1,u.forEach((s,a)=>{let o=t[a],h=a;p.length!==i&&(this.hasChannelsChanged=!0,h=i+a,t.push(this.addChannel(p[h],h)),o=t[h],this.registerZoomEvents(o)),o.series.clear(),o.series.addArraysXY(e,s.data)}),t.splice(p.length,t.length-p.length).forEach(s=>{this.hasChannelsChanged=!0,s.chart.dispose();for(let a in s)s[a]=null}),this.afterUpdate()}afterUpdate(){(!this.hasInitialized||this.hasChannelsChanged)&&(this.setXAxisStyle(),this.syncXAxesZoom()),requestAnimationFrame(()=>{(!this.hasInitialized||this.hasChannelsChanged)&&this.updateDashboardRowHeights(),this.resetView(),this.reportRenderEvent()})}}var Q=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}));class _ extends M(E(L(T))){}const x=new _,z=0,j=x.graphEvents;function F(...n){x.init(...n)}function O(...n){x.update(...n)}function B(){}function V(){}const N={get:(n,u,e)=>{if(n[u]&&typeof n[u]=="function")return n[u].bind(n);throw new Error(`API doesn't exist: ${u}`)}},R=new Proxy(x,N);var ee=Object.freeze(Object.defineProperty({__proto__:null,baseDate:z,graphEvents:j,init:F,update:O,showLoading:B,hideLoading:V,api:R},Symbol.toStringTag,{value:"Module"}));export{q as A,ee as L,X as a,W as b,K as c,Q as d,I as g,U as i,Y as l};
