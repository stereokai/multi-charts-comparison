import{l as a}from"./vendor.d274a670.js";import{c as S,g as D,G as A}from"./echarts.renderer.f38a4c36.js";function H(i=new Date){return i.setDate(i.getDate()-1),i.setHours(22)}const _={channels:{label:"Channels",min:10,max:25,value:10},period:{label:"Sleep period (h)",min:8,max:14,value:8},samples:{label:"Samples per second",min:1,max:100,value:1},total:{label:"Total samples"},lastEvent:{label:"Last event"},extraFeatures:{toggleGrid:!0,areaZoom:!1}};var P=_;const E=i=>class M extends i{static addChannel(e,t,s,r){const n=e.createChartXY({columnIndex:0,rowIndex:s,columnSpan:1,rowSpan:1,disableAnimations:!0}).setTitle("").setPadding({left:100,top:0,bottom:0}).setBackgroundStrokeStyle(a.emptyLine).setMouseInteractions(!1).setMouseInteractionPan(!0).setSeriesBackgroundFillStyle(new a.SolidFill({color:a.ColorCSS("white")})),l=n.getDefaultAxisX().setMouseInteractions(!1).setTickStrategy(a.AxisTickStrategies.Empty,c=>console.log(c)).setStrokeStyle(a.emptyLine),o=n.getDefaultAxisY().setMouseInteractions(!1).setChartInteractions(!1).setStrokeStyle(a.emptyLine).setTitle(t.name).setTitleFont(new a.FontSettings({size:12})).setTitleFillStyle(new a.SolidFill({color:a.ColorHEX("#6e7079")})).setTitleRotation(0).setThickness(60).setAnimationZoom(void 0).setTickStrategy(a.AxisTickStrategies.Numeric,c=>c.setMajorTickStyle(g=>g.setLabelFillStyle(new a.SolidFill({color:a.ColorHEX("#6e7079")})).setLabelFont(new a.FontSettings({size:6})).setTickStyle(a.emptyLine)).setMinorTickStyle(g=>g.setLabelFont(new a.FontSettings({size:6})).setTickStyle(a.emptyLine))),h=n.addLineSeries({dataPattern:{pattern:"ProgressiveX",regularProgressiveStep:!0,allowDataGrouping:!0},automaticColorIndex:typeof r=="number"?r:s}).setStrokeStyle(c=>c.setThickness(-1));return{chart:n,series:h,xAxis:l,yAxis:o,row:s}}addChannel(e,t,s){return M.addChannel(this.dashboard,e,t,s)}initializeChannels(e){this.graphs.splice(0,0,...e.map((t,s)=>this.addChannel(t,s))),this.graphs.forEach(t=>this.registerZoomEvents(t))}};var Y=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),x=`<svg id="areazoom-svg" style="position: absolute; z-index: 10000; width: 100%; height: 100%; pointer-events: none;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <!-- <rect id="resize" fill="red" x="190" y="160" width="20" height="20" /> -->
  <rect id="areazoom-rect" fill="rgba(50, 50, 50, 0.5)" />
</svg>`;let p,m;function v(i){i.insertAdjacentHTML("beforeend",x),p=document.getElementById("areazoom-rect")}function b(i){p.setAttribute("height",i)}function w(i){m=i,p.setAttribute("x",i)}function C(i){i>m?p.setAttribute("width",i-m):(p.setAttribute("width",m-i),p.setAttribute("x",i))}function k(){const i=p.getAttribute("x"),d=p.getAttribute("width");return p.setAttribute("width",0),{x:i|0,width:d|0}}var q=Object.freeze(Object.defineProperty({__proto__:null,svg:x,init:v,setHeight:b,setPosition:w,move:C,hide:k},Symbol.toStringTag,{value:"Module"})),U=Object.freeze(Object.defineProperty({__proto__:null,svg:x,init:v,setHeight:b,setPosition:w,move:C,hide:k},Symbol.toStringTag,{value:"Module"}));const T=i=>class f extends i{static visibleGridStyle=new a.SolidLine({thickness:1,fillStyle:new a.SolidFill({color:a.ColorCSS("#dfdfdf")})});static hiddenGridStyle=a.emptyLine;static getNewDashboard(e,t){return a.lightningChart({overrideInteractionMouseButtons:{chartXYPanMouseButton:0,chartXYRectangleZoomFitMouseButton:2}}).Dashboard({container:e,numberOfColumns:1,numberOfRows:t,theme:a.Themes.lightNew}).setBackgroundFillStyle(new a.SolidFill({color:a.ColorCSS("white")})).setSplitterStyle(a.emptyLine).setSplitterStyleHighlight(a.emptyLine)}newDashboard(e,t){this.dashboard=f.getNewDashboard(e,t),v(e)}updateDashboardRowHeights(){const{dashboard:e,graphs:t,pinnedGraphs:s,mainGraph:r,maxVisibleCharts:n}=this,l=t.map((u,I)=>I).filter(u=>!S[u].isHidden),o=s.map(u=>u.pinnedIndex),h=l.concat(o),c=r.xAxis.getHeight(),g=(e.engine.container.clientHeight-c)/h.length;for(let u=0;u<n;u++)h.includes(u)?e.setRowHeight(u,Math.round(g)):e.setRowHeight(u,1e-5);e.setRowHeight(r.row,Math.round(g+c)),window.dashboard=e,b(l.length*g)}setXAxisStyle(){this.graphs.forEach((e,t)=>{e.xAxis.setTickStrategy(a.AxisTickStrategies.Empty)}),this.mainGraph.xAxis.setTickStrategy(a.AxisTickStrategies.DateTime,e=>e.setDateOrigin(new Date(H())).setMajorTickStyle(t=>t.setGridStrokeStyle(a.emptyLine).setTickStyle(a.emptyLine)).setMinorTickStyle(t=>t.setGridStrokeStyle(a.emptyLine).setTickStyle(a.emptyLine)))}syncXAxesZoom(){this.axisSyncHandle&&this.axisSyncHandle.remove(),this.axisSyncHandle=a.synchronizeAxisIntervals(...this.graphs.map(e=>e.xAxis))}resetView(){const{mainGraph:e,minX:t,maxX:s}=this;e.xAxis.setInterval(t,s,!1,!0)}toggleGrid(e){this.graphs.forEach(t=>{const s=t.yAxis.getTickStrategy();t.yAxis.setTickStrategy(s,r=>r.setMajorTickStyle(n=>n.setGridStrokeStyle(e?f.visibleGridStyle:f.hiddenGridStyle)))})}toggleChannelVisibility(e){const t=this.graphs[e];S[e].isHidden?(t.series.dispose(),t.yAxis.dispose()):(t.series.restore(),t.yAxis.restore()),this.updateDashboardRowHeights()}toggleChannelSticky(e){const{pinnedGraphs:t,graphs:s}=this,r=s[e],n=S[e];if(n.isSticky){const l=t.length&&t[t.length-1].pinnedIndex-1||this.maxVisibleCharts-1,o=this.addChannel(n,l,e);o.isSticky=!0,o.pinnedIndex=l,t.push(o),o.series.add(r.series.kc[0].La),n.pinnedGraph=o}else{const l=n.pinnedGraph;n.pinnedGraph=null,t.splice(t.indexOf(l),1).forEach(o=>{o.chart.dispose();for(let h in o)o[h]=null})}this.updateDashboardRowHeights()}};var W=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}));const L=i=>class extends i{constructor(...e){super(...e);this.lastEvent=null,this.hasInitialized=!1,this.graphEvents=D()}markEvent(){this.lastEvent={timestamp:performance.now()}}registerZoomEvents(e){e.chart.onSeriesBackgroundMouseWheel((t,s)=>{let{deltaY:r}=s;const{xAxis:n,yAxis:l}=e,{start:o,end:h}=n.getInterval();r=-r;const c=this.getNewInterval(o,h,r);n.setInterval(c.start,c.end,!1,!0)})}getNewInterval(e,t,s,r=1e4){if(r<1e3)return!1;const{minX:n,maxX:l}=this,o=Math.min(l,Math.max(n,e+s*r)),h=Math.max(n,Math.min(l,t-s*r));return o*2>l?this.getNewInterval(e,t,s,r/2):{start:o,end:h}}reportRenderEvent(){requestAnimationFrame(()=>{const e=(performance.now()-this.lastEvent.timestamp)/1e3;this.hasInitialized?this.graphEvents.render({duration:e,type:A.render}):(this.hasInitialized=!0,this.graphEvents.init({duration:e,type:A.init})),this.lastEvent=null})}toggleAreaZoom(e){e?this.graphs.forEach(t=>{const{chart:s}=t;s.setMouseInteractionPan(!1),t.chartEvents={offSeriesBackgroundMouseDragStart:s.onSeriesBackgroundMouseDragStart((r,n,l)=>{l===0&&w(n.offsetX)}),offSeriesBackgroundMouseDrag:s.onSeriesBackgroundMouseDrag((r,n,l)=>{l===0&&C(n.offsetX)}),offSeriesBackgroundMouseDragStop:s.onSeriesBackgroundMouseDragStop((r,n,l)=>{if(l!==0)return;const o=k(),h=r.getSeries()[0].scale.x.getPixelSize(),g=this.mainGraph.xAxis.getInterval().start/h-160;this.mainGraph.xAxis.setInterval((g+o.x)*h,(g+o.x+o.width)*h,!1,!0)})}}):this.graphs.forEach(t=>{const{chart:s}=t;for(const[r,n]of Object.entries(t.chartEvents))s[r](n),t.chartEvents[r]=null;s.setMouseInteractionPan(!0)})}};var K=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));class G{get minX(){return this.timeSeries[0]}get maxX(){return this.timeSeries[this.timeSeries.length-1]}get mainGraph(){return this.graphs[this.graphs.length-1]}get maxVisibleCharts(){return P.channels.max}constructor(){this.graphs=[],this.pinnedGraphs=[]}init(d){this.markEvent(),this.newDashboard(d,this.maxVisibleCharts),this.initializeChannels(S),d.addEventListener("wheel",e=>{e.preventDefault()},{passive:!1})}update(d=[],e){this.hasInitialized&&this.markEvent(),e&&(this.timeSeries=e);const{graphs:t}=this,s=t.length;this.hasChannelsChanged=!1,d.forEach((r,n)=>{let l=t[n],o=n;S.length!==s&&(this.hasChannelsChanged=!0,o=s+n,t.push(this.addChannel(S[o],o)),l=t[o],this.registerZoomEvents(l)),l.series.clear(),l.series.addArraysXY(e,r.data)}),t.splice(S.length,t.length-S.length).forEach(r=>{this.hasChannelsChanged=!0,r.chart.dispose();for(let n in r)r[n]=null}),this.afterUpdate()}afterUpdate(){(!this.hasInitialized||this.hasChannelsChanged)&&(this.setXAxisStyle(),this.syncXAxesZoom()),requestAnimationFrame(()=>{(!this.hasInitialized||this.hasChannelsChanged)&&this.updateDashboardRowHeights(),this.resetView(),this.reportRenderEvent()})}}var Q=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));class z extends T(E(L(G))){}const y=new z,X=0,j=y.graphEvents;function F(...i){y.init(...i)}function O(...i){y.update(...i)}function B(){}function Z(){}const R={get:(i,d,e)=>{if(i[d]&&typeof i[d]=="function")return i[d].bind(i);throw new Error(`API doesn't exist: ${d}`)}},V=new Proxy(y,R);var ee=Object.freeze(Object.defineProperty({__proto__:null,baseDate:X,graphEvents:j,init:F,update:O,showLoading:B,hideLoading:Z,api:V},Symbol.toStringTag,{value:"Module"}));export{q as A,ee as L,P as a,W as b,K as c,Q as d,H as g,U as i,Y as l};
