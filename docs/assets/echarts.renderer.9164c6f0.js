import{w as P}from"./workerpool.b5f8dcf2.js";import{i as j}from"./echarts.40f2da25.js";let E=A();const p={},f=[],S=P.pool(new URL("/assets/CompiledWorker.f8938fcf.js",self.location).href,{maxWorkers:3});function A(){return Date.now()}function L(e){f.push(S.exec(e.name,[e.data]))}function R(e){console.log("Terminating operation",e),p[e]&&p[e](`Operation ${e} terminated`),S.terminate(!0),f.length=0}function z(e){return R(),E=e,()=>new Promise((t,n)=>{p[e]=n,Promise.all(f).then(o=>t(o))})}function w(e){const t=A(),n=z(t);return console.log(`Starting operation ${t}`),e(L),n().then(o=>E===t?(console.log(`Operation ${t} ended with results`,o),o):(console.log(`Operation ${t} ended but was terminated`,o),Promise.reject(`Operation ${t} ended but was terminated`)))}function h(e,t){return Math.random()*(t-e)+e}function _(e,t){let n=!1;return()=>{n||(e.apply(this,arguments),n=!0,setTimeout(()=>{n=!1},t))}}function B(e,t){let n=null;return()=>{n&&clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),n=null,e.apply(this,arguments)},t)}}const M={generateDataSeries:"generateDataSeries",setTotalSamples:"setTotalSamples"};function O(e,t){return{name:M.generateDataSeries,data:{channel:e,samples:t}}}const i=[{name:"PAT",min:-1e3,max:1e3,start:0,end:0,displacement:20,smoothing:-.1},{name:"PAT Amplitude",min:0,max:1e3,start:800,end:800,displacement:120,smoothing:.7},{name:"Pulse rate (BPM)",min:0,max:140,start:80,end:80,displacement:10,smoothing:.7},{name:"SaO2 (%)",min:0,max:100,start:93,end:93,displacement:5,smoothing:.3},{name:"Resp.Mov",min:-1e4,max:1e4,start:0,end:0,displacement:100,smoothing:-.1},{name:"Actigraph",min:1500,max:3e3,start:1700,end:1700,displacement:10,smoothing:.1},{name:"Snore (dB)",min:40,max:80,start:40,end:40,displacement:2,smoothing:.01},{name:"Channel 8",displacement:50,smoothing:.5},{name:"Channel 9",displacement:20,smoothing:.9},{name:"Channel 10",displacement:300,smoothing:1.2}];function g(e){return{name:"Channel "+e,displacement:h(30,400),smoothing:h(.1,2)}}function ne(e){return w(t=>{i.forEach(n=>t(O(n,e)))})}function oe(e,t,n=!0){if(e<1)throw new Error("Can't add 0 channels");return w(o=>{for(let a=0;a<e;a++){const c=i.length+1;n?o(O(i[i.push(g(c))-1],t)):i.push(g(c))}})}function ae(e){i.splice(i.length+e,-e)}const m={init:"init",render:"render",zoomPan:"zoomPan"};function N(){}function U(){const e=Object.keys(m).reduce((n,o)=>(n[m[o]]=N,n),{}),t=(...n)=>{n[0]in m&&(e[n[0]]=n[1])};return e.on=t,e}const T={toolbox:{left:"left",top:5,feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},axisPointer:{link:[{xAxisIndex:"all"}]}};var ie=Object.freeze(Object.defineProperty({__proto__:null,defaults:T},Symbol.toStringTag,{value:"Module"}));const l={onBeforeDataUpdate:"onBeforeDataUpdate",dataZoom:"dataZoom",brushselected:"brushselected",finished:"finished"},s=U();function d(...e){if(!(e[0]in m)&&!(e[0]in l)){typeof e[0]=="object"&&e[0].on(...e.slice(1));return}switch(e[0]){case l.onBeforeDataUpdate:s[l.onBeforeDataUpdate]=e[1];return;default:s.on(...e)}}let r=null,x=!1;const k=_(()=>{r={type:m.zoomPan,timestamp:performance.now()}},150),H=B(()=>{if(r){const e=(performance.now()-r.timestamp)/1e3;r.type===l.onBeforeDataUpdate&&(x?s.render({duration:e,type:m.render}):(x=!0,s.init({duration:e,type:m.init}))),s[r.type]&&s[r.type]({duration:e,type:r.type}),r=null}},100),v={[l.brushselected]:k,[l.finished]:H};d(l.onBeforeDataUpdate,()=>{r={type:l.onBeforeDataUpdate,timestamp:performance.now()}});var re=Object.freeze(Object.defineProperty({__proto__:null,ECHARTS_EVENTS:l,graphEvents:s,on:d,ECHARTS_EVENT_HANDLERS:v},Symbol.toStringTag,{value:"Module"}));const $={type:"time",boundaryGap:!1,axisLine:{onZero:!0}};function G(e){return{gridIndex:e,position:"top",show:!e,...$}}const Z={offset:35,type:"value",realtimeSort:!1,boundaryGap:!1,splitNumber:0,nameRotate:0,nameLocation:"middle",nameGap:0,axisLabel:{interval:0,showMinLabel:!0,showMaxLabel:!0,margin:-25,fontSize:8}};function I(e,t,n){return{gridIndex:e,name:t,...n,...Z}}const V={realtime:!0,start:0,end:100};function b(e,t){return{...V,...t,xAxisIndex:Object.keys(e)}}const Q={left:130,right:20};function W(e){return e.map((t,n)=>({...Q,top:10+n*90/e.length+"%",height:70/e.length+"%"}))}const q={type:"line",symbol:"none",sampling:"lttb",lineStyle:{width:1}};function F(e,t){return{...q,encode:{x:"timestamp",y:`channel_${t}`},xAxisIndex:t,yAxisIndex:t}}function C(e,t){const n={xAxis:e.map((o,a)=>G(a)),yAxis:e.map((o,a)=>I(a,o.name,{min:o.min,max:o.max,inverse:o.inverse})),dataZoom:[b(e,{type:"inside"}),b(e,{type:"slider",top:"top"})],grid:W(e),series:e.map((o,a)=>F(o,a))};return t&&(n.dataset={source:t}),n}var se=Object.freeze(Object.defineProperty({__proto__:null,buildEchartsOptions:C},Symbol.toStringTag,{value:"Module"}));let u,y=!1;function K(e){s.onBeforeDataUpdate(),u=j(e),Object.entries(v).forEach(([t,n])=>{d(u,t,n)}),window.addEventListener("resize",_(()=>{u.resize()},150))}function X(e,t){y?s.onBeforeDataUpdate():y=!0,e&&(e=D(e,t));const n=C(i,e);u.setOption(Object.assign(T,n),{replaceMerge:["series","yAxis","xAxis","grid"]})}function D(e,t){const n={};for(let o=0;o<e.length;o++){const a=i.length-e.length+o,c=e[o];n[`channel_${a}`]=c.data}return e.length===i.length&&(n.timestamp=t),n}function Y(){u.showLoading()}function J(){u.hideLoading()}var le=Object.freeze(Object.defineProperty({__proto__:null,init:K,update:X,buildModel:D,showLoading:Y,hideLoading:J,on:d},Symbol.toStringTag,{value:"Module"}));export{le as E,m as G,ae as a,oe as b,i as c,B as d,ie as e,re as f,U as g,se as h,ne as r};
