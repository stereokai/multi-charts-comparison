import{c as commonjsGlobal}from"./vendor.285b38b1.js";var workerpool$1={exports:{}};/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 6.2.0
 * @date    2022-01-15
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */(function(module,exports){(function(s,a){module.exports=a()})(typeof self<"u"?self:commonjsGlobal,function(){return function(){var __webpack_modules__={345:function(e,s,a){var f=a(219),_=a(751),p=a(828),y=a(833),l=new y;function d(t,n){typeof t=="string"?this.script=t||null:(this.script=null,n=t),this.workers=[],this.tasks=[],n=n||{},this.forkArgs=Object.freeze(n.forkArgs||[]),this.forkOpts=Object.freeze(n.forkOpts||{}),this.debugPortStart=n.debugPortStart||43210,this.nodeWorker=n.nodeWorker,this.workerType=n.workerType||n.nodeWorker||"auto",this.maxQueueSize=n.maxQueueSize||1/0,this.onCreateWorker=n.onCreateWorker||function(){return null},this.onTerminateWorker=n.onTerminateWorker||function(){return null},n&&"maxWorkers"in n?(b(n.maxWorkers),this.maxWorkers=n.maxWorkers):this.maxWorkers=Math.max((p.cpus||4)-1,1),n&&"minWorkers"in n&&(n.minWorkers==="max"?this.minWorkers=this.maxWorkers:(E(n.minWorkers),this.minWorkers=n.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&_.ensureWorkerThreads()}d.prototype.exec=function(t,n,u){if(n&&!Array.isArray(n))throw new TypeError('Array expected as argument "params"');if(typeof t=="string"){var k=f.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var g=this.tasks,T={method:t,params:n,resolver:k,timeout:null,options:u};g.push(T);var S=k.promise.timeout;return k.promise.timeout=function(M){return g.indexOf(T)!==-1?(T.timeout=M,k.promise):S.call(k.promise,M)},this._next(),k.promise}else{if(typeof t=="function")return this.exec("run",[String(t),n]);throw new TypeError('Function or string expected as argument "method"')}},d.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var t=this;return this.exec("methods").then(function(n){var u={};return n.forEach(function(k){u[k]=function(){return t.exec(k,Array.prototype.slice.call(arguments))}}),u})},d.prototype._next=function(){if(this.tasks.length>0){var t=this._getWorker();if(t){var n=this,u=this.tasks.shift();if(u.resolver.promise.pending){var k=t.exec(u.method,u.params,u.resolver,u.options).then(n._boundNext).catch(function(){if(t.terminated)return n._removeWorker(t)}).then(function(){n._next()});typeof u.timeout=="number"&&k.timeout(u.timeout)}else n._next()}}},d.prototype._getWorker=function(){for(var t=this.workers,n=0;n<t.length;n++){var u=t[n];if(u.busy()===!1)return u}return t.length<this.maxWorkers?(u=this._createWorkerHandler(),t.push(u),u):null},d.prototype._removeWorker=function(t){var n=this;return l.releasePort(t.debugPort),this._removeWorkerFromList(t),this._ensureMinWorkers(),new f(function(u,k){t.terminate(!1,function(g){n.onTerminateWorker({forkArgs:t.forkArgs,forkOpts:t.forkOpts,script:t.script}),g?k(g):u(t)})})},d.prototype._removeWorkerFromList=function(t){var n=this.workers.indexOf(t);n!==-1&&this.workers.splice(n,1)},d.prototype.terminate=function(t,n){var u=this;this.tasks.forEach(function(O){O.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var k=function(M){this._removeWorkerFromList(M)},g=k.bind(this),T=[],S=this.workers.slice();return S.forEach(function(O){var M=O.terminateAndNotify(t,n).then(g).always(function(){u.onTerminateWorker({forkArgs:O.forkArgs,forkOpts:O.forkOpts,script:O.script})});T.push(M)}),f.all(T)},d.prototype.stats=function(){var t=this.workers.length,n=this.workers.filter(function(u){return u.busy()}).length;return{totalWorkers:t,busyWorkers:n,idleWorkers:t-n,pendingTasks:this.tasks.length,activeTasks:n}},d.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var t=this.workers.length;t<this.minWorkers;t++)this.workers.push(this._createWorkerHandler())},d.prototype._createWorkerHandler=function(){var t=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,script:this.script})||{};return new _(t.script||this.script,{forkArgs:t.forkArgs||this.forkArgs,forkOpts:t.forkOpts||this.forkOpts,debugPort:l.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType})};function b(t){if(!P(t)||!x(t)||t<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function E(t){if(!P(t)||!x(t)||t<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function P(t){return typeof t=="number"}function x(t){return Math.round(t)==t}e.exports=d},219:function(e){function s(p,y){var l=this;if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(typeof p!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var d=[],b=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var E=function(n,u){d.push(n),b.push(u)};this.then=function(t,n){return new s(function(u,k){var g=t?a(t,u,k):u,T=n?a(n,u,k):k;E(g,T)},l)};var P=function(n){return l.resolved=!0,l.rejected=!1,l.pending=!1,d.forEach(function(u){u(n)}),E=function(k,g){k(n)},P=x=function(){},l},x=function(n){return l.resolved=!1,l.rejected=!0,l.pending=!1,b.forEach(function(u){u(n)}),E=function(k,g){g(n)},P=x=function(){},l};this.cancel=function(){return y?y.cancel():x(new f),l},this.timeout=function(t){if(y)y.timeout(t);else{var n=setTimeout(function(){x(new _("Promise timed out after "+t+" ms"))},t);l.always(function(){clearTimeout(n)})}return l},p(function(t){P(t)},function(t){x(t)})}function a(p,y,l){return function(d){try{var b=p(d);b&&typeof b.then=="function"&&typeof b.catch=="function"?b.then(y,l):y(b)}catch(E){l(E)}}}s.prototype.catch=function(p){return this.then(null,p)},s.prototype.always=function(p){return this.then(p,p)},s.all=function(p){return new s(function(y,l){var d=p.length,b=[];d?p.forEach(function(E,P){E.then(function(x){b[P]=x,d--,d==0&&y(b)},function(x){d=0,l(x)})}):y(b)})},s.defer=function(){var p={};return p.promise=new s(function(y,l){p.resolve=y,p.reject=l}),p};function f(p){this.message=p||"promise cancelled",this.stack=new Error().stack}f.prototype=new Error,f.prototype.constructor=Error,f.prototype.name="CancellationError",s.CancellationError=f;function _(p){this.message=p||"timeout exceeded",this.stack=new Error().stack}_.prototype=new Error,_.prototype.constructor=Error,_.prototype.name="TimeoutError",s.TimeoutError=_,e.exports=s},751:function(e,s,a){function f(o,i){var r=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(!r){if(Array.isArray(o)||(r=_(o))||i&&o&&typeof o.length=="number"){r&&(o=r);var c=0,w=function(){};return{s:w,n:function(){return c>=o.length?{done:!0}:{done:!1,value:o[c++]}},e:function(m){throw m},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W=!0,A=!1,h;return{s:function(){r=r.call(o)},n:function(){var m=r.next();return W=m.done,m},e:function(m){A=!0,h=m},f:function(){try{!W&&r.return!=null&&r.return()}finally{if(A)throw h}}}}function _(o,i){if(!!o){if(typeof o=="string")return p(o,i);var r=Object.prototype.toString.call(o).slice(8,-1);if(r==="Object"&&o.constructor&&(r=o.constructor.name),r==="Map"||r==="Set")return Array.from(o);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(o,i)}}function p(o,i){(i==null||i>o.length)&&(i=o.length);for(var r=0,c=new Array(i);r<i;r++)c[r]=o[r];return c}function y(o){return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},y(o)}var l=a(219),d=a(828),b=a(397),E="__workerpool-terminate__",P=1e3;function x(){var o=n();if(!o)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return o}function t(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":y(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function n(){try{return b("worker_threads")}catch(o){if(y(o)==="object"&&o!==null&&o.code==="MODULE_NOT_FOUND")return null;throw o}}function u(){if(d.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var o=new Blob([a(670)],{type:"text/javascript"});return window.URL.createObjectURL(o)}else return __dirname+"/worker.js"}function k(o,i){if(i.workerType==="web")return t(),g(o,Worker);if(i.workerType==="thread")return r=x(),T(o,r);if(i.workerType==="process"||!i.workerType)return S(o,O(i),b("child_process"));if(d.platform==="browser")return t(),g(o,Worker);var r=n();return r?T(o,r):S(o,O(i),b("child_process"))}function g(o,i){var r=new i(o);return r.isBrowserWorker=!0,r.on=function(c,w){this.addEventListener(c,function(W){w(W.data)})},r.send=function(c){this.postMessage(c)},r}function T(o,i){var r=new i.Worker(o,{stdout:!1,stderr:!1});return r.isWorkerThread=!0,r.send=function(c){this.postMessage(c)},r.kill=function(){return this.terminate(),!0},r.disconnect=function(){this.terminate()},r}function S(o,i,r){var c=r.fork(o,i.forkArgs,i.forkOpts);return c.isChildProcess=!0,c}function O(o){o=o||{};var i=process.execArgv.join(" "),r=i.indexOf("--inspect")!==-1,c=i.indexOf("--debug-brk")!==-1,w=[];return r&&(w.push("--inspect="+o.debugPort),c&&w.push("--debug-brk")),process.execArgv.forEach(function(W){W.indexOf("--max-old-space-size")>-1&&w.push(W)}),Object.assign({},o,{forkArgs:o.forkArgs,forkOpts:Object.assign({},o.forkOpts,{execArgv:(o.forkOpts&&o.forkOpts.execArgv||[]).concat(w)})})}function M(o){for(var i=new Error(""),r=Object.keys(o),c=0;c<r.length;c++)i[r[c]]=o[r[c]];return i}function j(o,i){var r=this,c=i||{};this.script=o||u(),this.worker=k(this.script,c),this.debugPort=c.debugPort,this.forkOpts=c.forkOpts,this.forkArgs=c.forkArgs,o||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("message",function(h){if(!r.terminated)if(typeof h=="string"&&h==="ready")r.worker.ready=!0,W();else{var v=h.id,m=r.processing[v];m!==void 0&&(h.isEvent?m.options&&typeof m.options.on=="function"&&m.options.on(h.payload):(delete r.processing[v],r.terminating===!0&&r.terminate(),h.error?m.resolver.reject(M(h.error)):m.resolver.resolve(h.result)))}});function w(h){r.terminated=!0;for(var v in r.processing)r.processing[v]!==void 0&&r.processing[v].resolver.reject(h);r.processing=Object.create(null)}function W(){var h=f(r.requestQueue.splice(0)),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;r.worker.send(m)}}catch(I){h.e(I)}finally{h.f()}}var A=this.worker;this.worker.on("error",w),this.worker.on("exit",function(h,v){var m=`Workerpool Worker terminated Unexpectedly
`;m+="    exitCode: `"+h+"`\n",m+="    signalCode: `"+v+"`\n",m+="    workerpool.script: `"+r.script+"`\n",m+="    spawnArgs: `"+A.spawnargs+"`\n",m+="    spawnfile: `"+A.spawnfile+"`\n",m+="    stdout: `"+A.stdout+"`\n",m+="    stderr: `"+A.stderr+"`\n",w(new Error(m))}),this.processing=Object.create(null),this.terminating=!1,this.terminated=!1,this.terminationHandler=null,this.lastId=0}j.prototype.methods=function(){return this.exec("methods")},j.prototype.exec=function(o,i,r,c){r||(r=l.defer());var w=++this.lastId;this.processing[w]={id:w,resolver:r,options:c};var W={id:w,method:o,params:i};this.terminated?r.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(W):this.requestQueue.push(W);var A=this;return r.promise.catch(function(h){if(h instanceof l.CancellationError||h instanceof l.TimeoutError)return delete A.processing[w],A.terminateAndNotify(!0).then(function(){throw h},function(v){throw v});throw h})},j.prototype.busy=function(){return Object.keys(this.processing).length>0},j.prototype.terminate=function(o,i){var r=this;if(o){for(var c in this.processing)this.processing[c]!==void 0&&this.processing[c].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}if(typeof i=="function"&&(this.terminationHandler=i),this.busy())this.terminating=!0;else{var w=function(h){if(r.terminated=!0,r.worker!=null&&r.worker.removeAllListeners&&r.worker.removeAllListeners("message"),r.worker=null,r.terminating=!1,r.terminationHandler)r.terminationHandler(h,r);else if(h)throw h};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){w(new Error("worker already killed!"));return}if(this.worker.isChildProcess){var W=setTimeout(function(){r.worker&&r.worker.kill()},P);this.worker.once("exit",function(){clearTimeout(W),r.worker&&(r.worker.killed=!0),w()}),this.worker.ready?this.worker.send(E):this.worker.requestQueue.push(E)}else this.worker.kill(),this.worker.killed=!0,w();return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");w()}},j.prototype.terminateAndNotify=function(o,i){var r=l.defer();return i&&(r.promise.timeout=i),this.terminate(o,function(c,w){c?r.reject(c):r.resolve(w)}),r.promise},e.exports=j,e.exports._tryRequireWorkerThreads=n,e.exports._setupProcessWorker=S,e.exports._setupBrowserWorker=g,e.exports._setupWorkerThreadWorker=T,e.exports.ensureWorkerThreads=x},833:function(e){var s=65535;e.exports=a;function a(){this.ports=Object.create(null),this.length=0}a.prototype.nextAvailableStartingAt=function(f){for(;this.ports[f]===!0;)f++;if(f>=s)throw new Error("WorkerPool debug port limit reached: "+f+">= "+s);return this.ports[f]=!0,this.length++,f},a.prototype.releasePort=function(f){delete this.ports[f],this.length--}},828:function(e,s,a){var f=a(397),_=function(d){return typeof d<"u"&&d.versions!=null&&d.versions.node!=null};e.exports.isNode=_,e.exports.platform=typeof process<"u"&&_(process)?"node":"browser";var p=y("worker_threads");e.exports.isMainThread=e.exports.platform==="node"?(!p||p.isMainThread)&&!process.connected:typeof Window<"u",e.exports.cpus=e.exports.platform==="browser"?self.navigator.hardwareConcurrency:f("os").cpus().length;function y(l){try{return f(l)}catch{return null}}},670:function(e){e.exports=`!function(){var __webpack_exports__={};!function(){var exports=__webpack_exports__,__webpack_unused_export__;function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}var requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \\" + module + \\" not found.') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}},WorkerThreads,parentPort;if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(r,e){addEventListener(r,function(r){e(r.data)})},worker.send=function(r){postMessage(r)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(error){if("object"!==_typeof(error)||null===error||"MODULE_NOT_FOUND"!==error.code)throw error}WorkerThreads&&null!==WorkerThreads.parentPort?(parentPort=WorkerThreads.parentPort,worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)):(worker.on=process.on.bind(process),worker.send=process.send.bind(process),worker.on("disconnect",function(){process.exit(1)}),worker.exit=process.exit.bind(process))}function convertError(o){return Object.getOwnPropertyNames(o).reduce(function(r,e){return Object.defineProperty(r,e,{value:o[e],enumerable:!0})},{})}function isPromise(r){return r&&"function"==typeof r.then&&"function"==typeof r.catch}worker.methods={},worker.methods.run=function(r,e){r=new Function("return ("+r+").apply(null, arguments);");return r.apply(r,e)},worker.methods.methods=function(){return Object.keys(worker.methods)};var currentRequestId=null;worker.on("message",function(e){if(e===TERMINATE_METHOD_ID)return worker.exit(0);try{var r=worker.methods[e.method];if(!r)throw new Error('Unknown method "'+e.method+'"');currentRequestId=e.id;var o=r.apply(r,e.params);isPromise(o)?o.then(function(r){worker.send({id:e.id,result:r,error:null}),currentRequestId=null}).catch(function(r){worker.send({id:e.id,result:null,error:convertError(r)}),currentRequestId=null}):(worker.send({id:e.id,result:o,error:null}),currentRequestId=null)}catch(r){worker.send({id:e.id,result:null,error:convertError(r)})}}),worker.register=function(r){if(r)for(var e in r)r.hasOwnProperty(e)&&(worker.methods[e]=r[e]);worker.send("ready")},worker.emit=function(r){currentRequestId&&worker.send({id:currentRequestId,isEvent:!0,payload:r})},__webpack_unused_export__=worker.register,worker.emit}()}();`},397:function(module){var requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`);module.exports=requireFoolWebpack},744:function(__unused_webpack_module,exports){function _typeof(e){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},_typeof(e)}var requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function e(){}};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")worker.on=function(e,s){addEventListener(e,function(a){s(a.data)})},worker.send=function(e){postMessage(e)};else if(typeof process<"u"){var WorkerThreads;try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(e){if(!(_typeof(e)==="object"&&e!==null&&e.code==="MODULE_NOT_FOUND"))throw e}if(WorkerThreads&&WorkerThreads.parentPort!==null){var parentPort=WorkerThreads.parentPort;worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)}else worker.on=process.on.bind(process),worker.send=process.send.bind(process),worker.on("disconnect",function(){process.exit(1)}),worker.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function convertError(e){return Object.getOwnPropertyNames(e).reduce(function(s,a){return Object.defineProperty(s,a,{value:e[a],enumerable:!0})},{})}function isPromise(e){return e&&typeof e.then=="function"&&typeof e.catch=="function"}worker.methods={},worker.methods.run=function e(s,a){var f=new Function("return ("+s+").apply(null, arguments);");return f.apply(f,a)},worker.methods.methods=function e(){return Object.keys(worker.methods)};var currentRequestId=null;worker.on("message",function(e){if(e===TERMINATE_METHOD_ID)return worker.exit(0);try{var s=worker.methods[e.method];if(s){currentRequestId=e.id;var a=s.apply(s,e.params);isPromise(a)?a.then(function(f){worker.send({id:e.id,result:f,error:null}),currentRequestId=null}).catch(function(f){worker.send({id:e.id,result:null,error:convertError(f)}),currentRequestId=null}):(worker.send({id:e.id,result:a,error:null}),currentRequestId=null)}else throw new Error('Unknown method "'+e.method+'"')}catch(f){worker.send({id:e.id,result:null,error:convertError(f)})}}),worker.register=function(e){if(e)for(var s in e)e.hasOwnProperty(s)&&(worker.methods[s]=e[s]);worker.send("ready")},worker.emit=function(e){currentRequestId&&worker.send({id:currentRequestId,isEvent:!0,payload:e})},exports.add=worker.register,exports.emit=worker.emit}},__webpack_module_cache__={};function __webpack_require__(e){var s=__webpack_module_cache__[e];if(s!==void 0)return s.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}var __webpack_exports__={};return function(){var e=__webpack_exports__,s=__webpack_require__(828);e.pool=function(f,_){var p=__webpack_require__(345);return new p(f,_)},e.worker=function(f){var _=__webpack_require__(744);_.add(f)},e.workerEmit=function(f){var _=__webpack_require__(744);_.emit(f)},e.Promise=__webpack_require__(219),e.platform=s.platform,e.isMainThread=s.isMainThread,e.cpus=s.cpus}(),__webpack_exports__}()})})(workerpool$1);var workerpool=workerpool$1.exports;export{workerpool as w};
